import"./main-B3CKXS3W.js";import{r as s}from"./renderPagination-DiElxoko.js";import{C,i as $}from"./component-popup-DlzYQJtm.js";import"./api-CdacEXtS.js";document.getElementById("catalog");const h=document.getElementById("search"),_=document.getElementById("sort"),S=document.getElementById("reset"),I=document.getElementById("sortCategory"),q=document.getElementById("sortByName"),P=document.getElementById("sortByPriceAsc"),b=document.getElementById("sortByPriceDesc"),w=document.getElementById("filterExpensive"),H=document.getElementById("filterCheap"),M=document.getElementById("filterInStock");document.getElementById("uniqueStyles");async function R(){h.addEventListener("input",async e=>{const t=h.value.toLowerCase();if(t==="")return s(!0);try{s(!0,`?q=${t}`)}catch(n){console.error("Ошибка при поиске:",n)}}),_.addEventListener("change",async e=>{let t="";_.value==="name"&&(t="_sort=name&_order=asc"),_.value==="price"&&(t="_sort=price&_order=asc"),_.value==="style"&&(t="_sort=style&_order=asc"),s(!0,t?`?${t}`:"")}),I.addEventListener("change",e=>{const t=e.target.value;let n="";t!=="all"&&(n=`?category=${t}`),s(!0,n)}),S.addEventListener("click",e=>{h.value="",_.value="default",s(!0)}),q.addEventListener("click",()=>{s(!0,"?_sort=name&_order=asc")}),P.addEventListener("click",()=>{s(!0,"?_sort=price&_order=asc")}),b.addEventListener("click",()=>{s(!0,"?_sort=price&_order=desc")}),w.addEventListener("click",()=>{s(!0,"?price_gte=50000")}),H.addEventListener("click",async()=>{s(!0,"?price_lte=10000")}),M.addEventListener("click",()=>{s(!0,"?in_stock=true")})}function A(){const e=document.querySelectorAll(".wrapper-logic__checkbox");e.forEach(t=>{t.addEventListener("change",async()=>{const n=Array.from(e).filter(a=>a.checked).map(a=>a.id);let r=[];n.includes("name")&&r.push("_sort=name&_order=asc"),n.includes("category")&&r.push("_sort=category&_order=asc"),n.includes("price")&&r.push("_sort=price&_order=asc"),n.includes("material")&&r.push("material_ne=null"),n.includes("description")&&r.push("description_ne=null"),n.includes("in_stock")&&r.push("in_stock=true");const d=r.join("&");try{s(!0,`?${d}`)}catch(a){console.error("Ошибка при фильтрации:",a)}})})}function D(e,t){const n=e.getBoundingClientRect(),r=t.getBoundingClientRect();return!(n.right<r.left||n.left>r.right)}function T(){const e=document.getElementById("slider");if(!e)return;const t=e.querySelector(".range-slider__track"),n=e.querySelector(".range-slider__range"),r=e.querySelector(".range-slider__handle_min"),d=e.querySelector(".range-slider__handle_max"),a=e.querySelector(".range-slider__value_min"),u=e.querySelector(".range-slider__value_max"),i=e.querySelector(".range-slider__value_both"),o=e.dataset.min,y=e.dataset.max;let c=0,l=y;function E(){const m=(c-o)/(y-o)*100,p=(l-o)/(y-o)*100;n.style.left=`${m}%`,n.style.width=`${p-m}%`,r.style.left=`${m}%`,d.style.left=`${p}%`,a.textContent=`${c}₽`,u.textContent=`${l}₽`,i.innerHTML=`<i>${c}₽ - </i>${l}₽`,c===l?i.querySelector("i").style.display="none":i.querySelector("i").style.display="inline",D(a,u)?(a.style.opacity="0",u.style.opacity="0",i.style.display="block"):(a.style.opacity="1",u.style.opacity="1",i.style.display="none")}function B(m,p){let v=!1;m.addEventListener("mousedown",k=>{v=!0;const g=()=>{v=!1,s(!0,`?price_gte=${c}&price_lte=${l}`),document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",g)};document.addEventListener("mousemove",L),document.addEventListener("mouseup",g)});function L(k){if(!v)return;const g=t.getBoundingClientRect();let f=(k.clientX-g.left)/g.width;f=Math.max(0,Math.min(1,f));const x=Math.round(o+f*(y-o));p?c=Math.min(x,l):l=Math.max(x,c),E()}}B(r,!0),B(d,!1),E()}class N extends HTMLElement{constructor(){super(),this.innerHTML=`
            <div class="range-slider">
              <div class="range-slider__track">
                <div class="range-slider__range"></div>
                <div class="range-slider__handle range-slider__handle_min"></div>
                <div class="range-slider__handle range-slider__handle_max"></div>
              </div>
              <div class="range-slider__labels">
                <span class="range-slider__value range-slider__value_min"></span>
                <span class="range-slider__value range-slider__value_max"></span>
                <span class="range-slider__value range-slider__value_both"></span>
              </div>
            </div>
        `}}customElements.define("widget-range-slider",N);customElements.define("widget-popup",C);function V(){catalog.addEventListener("click",e=>{const t=e.target.closest(".catalog-cart"),n=e.target.closest(".catalog-cart__buttons");if(t&&!n){const r=t.dataset.name,d=t.dataset.price,a=t.dataset.description,u=t.dataset.stock,i=t.dataset.style,o=`
                <p><strong>Цена:</strong> ${d}</p>
                <p><strong>Описание:</strong> ${a}</p>
                <p><strong>Наличие:</strong> ${u}</p>
                <p><strong>Стиль:</strong> ${i}</p>
            `;$(r,o)}})}function j(){V(),s(!0),R(),A(),T()}window.addEventListener("load",()=>{const e=document.getElementById("preloader");e&&setTimeout(()=>{e.style.opacity="0",e.style.visibility="hidden"},1e3)});document.addEventListener("DOMContentLoaded",()=>{j()});
